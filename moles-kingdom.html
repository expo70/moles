<html>
<head><meta charset="utf-8">
<title>Moles Kingdom</title>

<script src="../js/snap.svg-min.js"></script>
</head>

<body>
<script>

window.onload = function() {
	var r = 1/8,
		a = 1/8,
		b = 1/6,
		alpha = Math.sqrt(r*r/(a*a+b*b)),
		d1x = -1/2,
		d1y =  1/2,
		ex =  r - alpha*b,
		ey = -r + alpha*a,
		deltaX_x = 1,
		deltaX_y = 0,
		deltaY_x = -1/8,
		deltaY_y = -1/5.9,
		s = Snap("#cave-container");

	// initialize scene
	Snap.load("../image/cave001.svg", function(frag) {
		s.append(frag);
		console.log(frag);
	});

	var mole_front = Snap().remove();

	// load mole sprite
	Snap.load("../image/mole.svg", function(frag) {
		mole_front.append(frag.select(".front")
			.transform("translate(300,150)"));
		mole_left  = frag.select(".left");
		mole_right = frag.select(".right");
	});
	console.log(mole_front);

	// draw A block (size 1x1)
	// x, y: center coordinate (Mathematical)
	// R,G,B: color components (0-255)
	function draw_block(x,y,R,G,B)
	{
		var t11x = x+d1x+ex; var t11y = y+d1y+ey;
		var t12x = t11x + a; var t12y = t11y;
		var t13x = t11x + a; var t13y = t11y + b;
	
		var t21x = x-d1x-ex; var t21y = y-d1y-ey;
		var t22x = t21x;     var t22y = t21y + b;
		var t23x = t21x + a; var t23y = t21y + b;
	
		var color        = Snap.rgb(R,G,B);
		var darker_color = Snap.rgb(R/2,G/2,B/2);
	
		var poly1 = s.polygon([t11x, t11y, t12x, t12y, t13x, t13y]);
		var poly2 = s.polygon([t21x, t21y, t22x, t22y, t23x, t23y]);
		var rect1 = s.rect(x-1/2+a,y-1/2+b,1,1,r);
		var lateral = s.group(poly1, poly2, rect1);
		lateral
			.attr({
				fill: darker_color
			})
			.transform("translate(0,200) scale(35,-35)");

		var frontal = s.rect(x-1/2,y-1/2,1,1,r);
		frontal
			.attr({
				fill: color
			})
			.transform("translate(0,200) scale(35,-35)");
	}
	
	function placed_block(name, nx, ny)
	{
		draw_block(
			nx*deltaX_x+ny*deltaY_x,
			nx*deltaX_y+ny*deltaY_y,
			100,0,0);
	}

	draw_block(1,0,100,0,0);
	draw_block(2,0,0,0,100);
	draw_block(3,0,0,100,0);

	s.append(mole_front);

	//block(200,200,100,0,0);
	//block(300,200,0,0,100);
	//placed_block("test",1,0);
	//placed_block("test",2,0);
	//placed_block("test",2,1);


}



</script>

<svg id="cave-container" width=600 height=400></svg>


</body>
</html>
